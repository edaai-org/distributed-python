

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2.2. Series 与 DataFrame &#8212; Python 数据科学实战</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch-pandas/series-dataframe';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.3. 数据切片" href="dataframe-slicing.html" />
    <link rel="prev" title="2.1. pandas 简介" href="pandas-intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Python 数据科学实战 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Python 数据科学实战 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Python 数据科学实战
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">数据处理与计算</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch-numpy/index.html">1. NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/numpy-intro.html">1.1. NumPy 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/ndarray.html">1.2. ndarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/ndarray-slicing-index.html">1.3. 切片与索引</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/random.html">1.4. 随机数生成</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">2. pandas</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pandas-intro.html">2.1. pandas 简介</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.2. Series 与 DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-slicing.html">2.3. 数据切片</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-preprocessing.html">2.4. 数据处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-groupby.html">2.5. 分组汇总</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-merge-concat.html">2.6. 多表操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-pivot-melt.html">2.7. 数据透视</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">数据可视化</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch-matplotlib/index.html">3. Matplotlib</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch-matplotlib/matplotlib-intro.html">3.1. Matplotlib 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-matplotlib/matplotlib-figure-axes.html">3.2. <code class="docutils literal notranslate"><span class="pre">Figure</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Axes</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-matplotlib/matplotlib-data.html">3.3. Matplotlib 输入数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-matplotlib/matplotlib-other-parameters.html">3.4. matplotlib 其他画图参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-matplotlib/matplotlib-coding-styles.html">3.5. matplotlib 编程方式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-matplotlib/matplotlib-plot-types.html">3.6. 图形种类</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/godaai/python-data-science" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/godaai/python-data-science/issues/new?title=Issue%20on%20page%20%2Fch-pandas/series-dataframe.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ch-pandas/series-dataframe.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Series 与 DataFrame</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">2.2.1. Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">2.2.2. DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.2.2.1. 创建 DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2.2.2. 计算统计量</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pwt">2.2.3. 案例：PWT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.2.3.1. 查看数据</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="series-dataframe">
<h1><span class="section-number">2.2. </span>Series 与 DataFrame<a class="headerlink" href="#series-dataframe" title="Permalink to this heading">#</a></h1>
<p>pandas 的核心数据结构有两个： Series 和 DataFrame。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="series">
<h2><span class="section-number">2.2.1. </span>Series<a class="headerlink" href="#series" title="Permalink to this heading">#</a></h2>
<p>在 pandas 中，<code class="docutils literal notranslate"><span class="pre">Series</span></code> 是一种一维的带标签的 <strong>数组状</strong> 数据结构。</p>
<figure class="align-default" id="series-img">
<a class="reference internal image-reference" href="../_images/Series.svg"><img alt="../_images/Series.svg" src="../_images/Series.svg" width="200px" /></a>
<figcaption>
<p><span class="caption-number">图 2.1 </span><span class="caption-text">Series</span><a class="headerlink" href="#series-img" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>我们创建一个 <code class="docutils literal notranslate"><span class="pre">Series</span></code>，这个数组有 4 个数，并命名为 <code class="docutils literal notranslate"><span class="pre">my_series</span></code>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;my_series&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> 是一个数组状数据结构，其实就是 <a class="reference internal" href="../ch-numpy/ndarray.html#numpy-ndarray"><span class="std std-numref">章节 1.2</span></a> 中的 <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>。 数组最重要的结构是索引（Index）。Index 主要用于标记第几个位置存储什么数据。<code class="docutils literal notranslate"><span class="pre">pd.Series()</span></code> 中不指定 Index 参数时，默认从 0 开始，逐一自增，形如： 0，1，…</p>
<ul class="simple">
<li><p>Series 支持计算操作。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    100
1    200
2    300
3    400
Name: my_series, dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Series 支持描述性统计。比如，获得所有统计信息。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    4.000000
mean     2.500000
std      1.290994
min      1.000000
25%      1.750000
50%      2.500000
75%      3.250000
max      4.000000
Name: my_series, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>计算平均值，中位数和标准差。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.2909944487358056
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Series 的索引很灵活。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;number1&#39;</span><span class="p">,</span><span class="s1">&#39;number2&#39;</span><span class="p">,</span><span class="s1">&#39;number3&#39;</span><span class="p">,</span><span class="s1">&#39;number4&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>这时，<code class="docutils literal notranslate"><span class="pre">Series</span></code> 就像一个 Python 中的字典 <code class="docutils literal notranslate"><span class="pre">dict</span></code>，可以使用像 <code class="docutils literal notranslate"><span class="pre">dict</span></code> 一样的语法来访问 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 中的元素，其中 <code class="docutils literal notranslate"><span class="pre">index</span></code> 相当于 <code class="docutils literal notranslate"><span class="pre">dict</span></code> 的键 <code class="docutils literal notranslate"><span class="pre">key</span></code>。例如，使用 <code class="docutils literal notranslate"><span class="pre">[]</span></code> 操作符访问 <code class="docutils literal notranslate"><span class="pre">number1</span></code> 对应的值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;number1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>又例如，使用 <code class="docutils literal notranslate"><span class="pre">in</span></code> 表达式判断某个索引是否在 Series 中。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;number1&#39;</span> <span class="ow">in</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataframe">
<h2><span class="section-number">2.2.2. </span>DataFrame<a class="headerlink" href="#dataframe" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 可以简单理解为一个 Excel 表，有很多列和很多行，如 <a class="reference internal" href="#dataframe-img"><span class="std std-numref">图 2.2</span></a> 所示。
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 的列（column）表示一个字段；<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 的行（row）表示一条数据。<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 常被用来分析像 Excel 这样的、有行和列的表格类数据。Excel 也正在兼容 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>，使得用户在 Excel 中进行 pandas 数据处理与分析。</p>
<figure class="align-default" id="dataframe-img">
<a class="reference internal image-reference" href="../_images/DataFrame.svg"><img alt="../_images/DataFrame.svg" src="../_images/DataFrame.svg" width="400px" /></a>
<figcaption>
<p><span class="caption-number">图 2.2 </span><span class="caption-text">DataFrame 示意图</span><a class="headerlink" href="#dataframe-img" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="id1">
<h3><span class="section-number">2.2.2.1. </span>创建 DataFrame<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>创建一个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 有很多方式，比如从列表、字典、文件中读取数据，并创建一个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>。</p>
<ul class="simple">
<li><p>基于列表创建</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">]</span>
<span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">]</span>
<span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;Los Angeles&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="n">ages</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="n">cities</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>基于字典创建</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;Column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>基于文件创建</p></li>
</ul>
<p>如 <a class="reference internal" href="#file-img"><span class="std std-numref">图 2.3</span></a> 所示，pandas 可以读取不同类型的文件，进行处理，最后持久化地写入不同类型的文件中。</p>
<figure class="align-default" id="file-img">
<a class="reference internal image-reference" href="../_images/file.svg"><img alt="../_images/file.svg" src="../_images/file.svg" width="600px" /></a>
<figcaption>
<p><span class="caption-number">图 2.3 </span><span class="caption-text">文件读取/写入</span><a class="headerlink" href="#file-img" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>对于不同类型的文件，使用不同的函数，比如 <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> 读取 csv 类型的数据。<code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">pd.read_csv('/path/file.csv')</span></code> 用来读取一个 csv 文件，<code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span>&#160; <span class="pre">pd.read_excel('/path/file.xlsx')</span></code> 用来读取一个 Excel 文件。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>注：csv 文件一般由很多个 column 组成，使用 pd.read_csv 时，默认每个 column 之间的分隔符为逗号（,），pd.read_table 默认分隔符为换行符。这些函数还支持许多其他参数，可以使用 help() 函数查看。</p>
<p>同样地，我们最终也可以将处理过的 DataFrame 写入文件即以文件的格式输出，例：df.to_excel(‘/path/file.xlsx’)则输出为excel文件。</p>
</div>
</section>
<section id="id2">
<h3><span class="section-number">2.2.2.2. </span>计算统计量<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>前面我们讲过对 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 对象我们可以计算统计量，而 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 是由一列列 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 对象构成的，自然也可以做相应的计算。</p>
<ul class="simple">
<li><p>对某一列计算相应统计量，本质上还是对 <code class="docutils literal notranslate"><span class="pre">Series</span></code> 对象做统计量计算，如 <a class="reference internal" href="#s1-img"><span class="std std-numref">图 2.4</span></a>。</p></li>
</ul>
<figure class="align-default" id="s1-img">
<a class="reference internal image-reference" href="../_images/s1.svg"><img alt="../_images/s1.svg" src="../_images/s1.svg" width="600px" /></a>
<figcaption>
<p><span class="caption-number">图 2.4 </span><span class="caption-text">对 Dataframe 一列对象做统计量</span><a class="headerlink" href="#s1-img" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>例：对 <code class="docutils literal notranslate"><span class="pre">df</span></code> 的第一列求平均值。（<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 对象的切片操作后续会详细讲解。）</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------- df is -------</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------- Column1.mean() -------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Column1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------- df is -------
   Column1  Column2
0        1        3
1        2        4
------- Column1.mean() -------

Column1    1.5
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>对某几列计算相应统计量。</p></li>
</ul>
<figure class="align-default" id="s2-img">
<a class="reference internal image-reference" href="../_images/s2.svg"><img alt="../_images/s2.svg" src="../_images/s2.svg" width="600px" /></a>
<figcaption>
<p><span class="caption-number">图 2.5 </span><span class="caption-text">对 Dataframe 几列对象做统计量</span><a class="headerlink" href="#s2-img" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>例：对 <code class="docutils literal notranslate"><span class="pre">df</span></code> 的第一列和第二列进行描述性统计。</p>
<blockquote>
<div><p>由于这里的 <code class="docutils literal notranslate"><span class="pre">df</span></code> 只有两列，也可以直接对整个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 对象操作，即等价于 <code class="docutils literal notranslate"><span class="pre">df.describe()</span></code></p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Column1&#39;</span><span class="p">,</span><span class="s1">&#39;Column2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column1</th>
      <th>Column2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.500000</td>
      <td>3.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.707107</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.250000</td>
      <td>3.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.500000</td>
      <td>3.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.750000</td>
      <td>3.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.000000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>使用 <code class="docutils literal notranslate"><span class="pre">DataFrame.agg()</span></code> 方法计算特定的统计量组合。</p></li>
</ul>
<p>有时候我们对一列需要指定的一些统计量，对不同列又有不同的需求，则可以使用 <code class="docutils literal notranslate"><span class="pre">DataFrame.agg()</span></code> 方法，传入字典参数，<code class="docutils literal notranslate"><span class="pre">key</span></code> 为列名，<code class="docutils literal notranslate"><span class="pre">value</span></code> 为需要的统计量的列表。</p>
<p>例：对 <code class="docutils literal notranslate"><span class="pre">df</span></code> 的第一列获得最小值 / 最大值 / 中位数 / 偏度，对第二列获得最小值 / 最大值 / 中位数 / 均值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Column1&#39;</span><span class="p">:[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;median&#39;</span><span class="p">,</span><span class="s1">&#39;skew&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Column2&#39;</span><span class="p">:[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;median&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>   
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column1</th>
      <th>Column2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>1.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>median</th>
      <td>1.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>skew</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>3.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="pwt">
<h2><span class="section-number">2.2.3. </span>案例：PWT<a class="headerlink" href="#pwt" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://www.rug.nl/ggdc/productivity/pwt/">PWT</a> 是一个经济学数据库，用于比较国家和地区之间的宏观经济数据，该数据集包含了各种宏观经济指标，如国内生产总值（GDP）、人均收入、劳动力和资本等因素，以及价格水平、汇率等信息。我们先下载，并使用 pandas 简单探索该数据集。</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;../data/pwt&quot;</span><span class="p">)</span>
<span class="n">download_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.rug.nl/ggdc/docs/pwt70_06032011version.zip&quot;</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="n">download_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="c1"># 创建文件夹</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;文件夹不存在，已创建。&quot;</span><span class="p">)</span>

    <span class="n">zip_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">download_url</span><span class="p">,</span> <span class="n">zip_file_path</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;数据已下载并解压缩。&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;文件夹已存在，无需操作。&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>文件夹已存在，无需操作。
</pre></div>
</div>
</div>
</details>
</div>
<section id="id3">
<h3><span class="section-number">2.2.3.1. </span>查看数据<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>使用 <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> 读取数据。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s2">&quot;pwt70_w_country_names.csv&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">head()</span></code> 函数可以指定查看前 n 行。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>isocode</th>
      <th>year</th>
      <th>POP</th>
      <th>XRAT</th>
      <th>Currency_Unit</th>
      <th>ppp</th>
      <th>tcgdp</th>
      <th>cgdp</th>
      <th>cgdp2</th>
      <th>...</th>
      <th>kg</th>
      <th>ki</th>
      <th>openk</th>
      <th>rgdpeqa</th>
      <th>rgdpwok</th>
      <th>rgdpl2wok</th>
      <th>rgdpl2pe</th>
      <th>rgdpl2te</th>
      <th>rgdpl2th</th>
      <th>rgdptt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>1950</td>
      <td>8150.368</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>1951</td>
      <td>8284.473</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>1952</td>
      <td>8425.333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>1953</td>
      <td>8573.217</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>1954</td>
      <td>8728.408</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tail()</span></code> 函数指定查看后 n 行。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>isocode</th>
      <th>year</th>
      <th>POP</th>
      <th>XRAT</th>
      <th>Currency_Unit</th>
      <th>ppp</th>
      <th>tcgdp</th>
      <th>cgdp</th>
      <th>cgdp2</th>
      <th>...</th>
      <th>kg</th>
      <th>ki</th>
      <th>openk</th>
      <th>rgdpeqa</th>
      <th>rgdpwok</th>
      <th>rgdpl2wok</th>
      <th>rgdpl2pe</th>
      <th>rgdpl2te</th>
      <th>rgdpl2th</th>
      <th>rgdptt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11395</th>
      <td>Zimbabwe</td>
      <td>ZWE</td>
      <td>2005</td>
      <td>11639.470</td>
      <td>2.236364e+01</td>
      <td>Zimbabwe Dollar</td>
      <td>39.482829</td>
      <td>1968.205961</td>
      <td>169.097559</td>
      <td>184.183929</td>
      <td>...</td>
      <td>6.995770</td>
      <td>9.376272</td>
      <td>89.399427</td>
      <td>214.739197</td>
      <td>418.970867</td>
      <td>418.970867</td>
      <td>NaN</td>
      <td>390.907086</td>
      <td>NaN</td>
      <td>169.097559</td>
    </tr>
    <tr>
      <th>11396</th>
      <td>Zimbabwe</td>
      <td>ZWE</td>
      <td>2006</td>
      <td>11544.326</td>
      <td>1.643606e+02</td>
      <td>Zimbabwe Dollar</td>
      <td>384.899651</td>
      <td>2132.305773</td>
      <td>184.705956</td>
      <td>192.953943</td>
      <td>...</td>
      <td>7.648020</td>
      <td>14.986823</td>
      <td>81.697014</td>
      <td>217.543648</td>
      <td>424.754259</td>
      <td>407.262097</td>
      <td>NaN</td>
      <td>377.352394</td>
      <td>NaN</td>
      <td>179.368685</td>
    </tr>
    <tr>
      <th>11397</th>
      <td>Zimbabwe</td>
      <td>ZWE</td>
      <td>2007</td>
      <td>11443.187</td>
      <td>9.675781e+03</td>
      <td>Zimbabwe Dollar</td>
      <td>38583.323960</td>
      <td>2107.937100</td>
      <td>184.208918</td>
      <td>198.215361</td>
      <td>...</td>
      <td>8.387106</td>
      <td>15.787322</td>
      <td>84.483374</td>
      <td>202.707080</td>
      <td>396.486201</td>
      <td>376.163064</td>
      <td>NaN</td>
      <td>345.764991</td>
      <td>NaN</td>
      <td>173.113448</td>
    </tr>
    <tr>
      <th>11398</th>
      <td>Zimbabwe</td>
      <td>ZWE</td>
      <td>2008</td>
      <td>11350.000</td>
      <td>6.715424e+09</td>
      <td>Zimbabwe Dollar</td>
      <td>38723.957740</td>
      <td>1772.209867</td>
      <td>156.141839</td>
      <td>162.112294</td>
      <td>...</td>
      <td>7.685312</td>
      <td>13.444449</td>
      <td>85.117130</td>
      <td>174.178806</td>
      <td>343.159758</td>
      <td>332.649861</td>
      <td>NaN</td>
      <td>302.945712</td>
      <td>NaN</td>
      <td>142.329054</td>
    </tr>
    <tr>
      <th>11399</th>
      <td>Zimbabwe</td>
      <td>ZWE</td>
      <td>2009</td>
      <td>11383.000</td>
      <td>1.400000e+17</td>
      <td>Zimbabwe Dollar</td>
      <td>40289.958990</td>
      <td>1906.049843</td>
      <td>167.447056</td>
      <td>174.419700</td>
      <td>...</td>
      <td>7.905525</td>
      <td>14.743667</td>
      <td>83.749534</td>
      <td>182.613004</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>314.171069</td>
      <td>NaN</td>
      <td>151.435285</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">info()</span></code> 函数可以查看数据基本信息，包括字段类型和非空值计数。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 11400 entries, 0 to 11399
Data columns (total 37 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   country        11400 non-null  object 
 1   isocode        11400 non-null  object 
 2   year           11400 non-null  int64  
 3   POP            11398 non-null  float64
 4   XRAT           10163 non-null  float64
 5   Currency_Unit  10163 non-null  object 
 6   ppp            8745 non-null   float64
 7   tcgdp          8745 non-null   float64
 8   cgdp           8745 non-null   float64
 9   cgdp2          8745 non-null   float64
 10  cda2           8745 non-null   float64
 11  cc             8745 non-null   float64
 12  cg             8745 non-null   float64
 13  ci             8745 non-null   float64
 14  p              8745 non-null   float64
 15  p2             8745 non-null   float64
 16  pc             8745 non-null   float64
 17  pg             8745 non-null   float64
 18  pi             8745 non-null   float64
 19  openc          8745 non-null   float64
 20  cgnp           8305 non-null   float64
 21  y              8745 non-null   float64
 22  y2             8745 non-null   float64
 23  rgdpl          8725 non-null   float64
 24  rgdpl2         8725 non-null   float64
 25  rgdpch         8725 non-null   float64
 26  kc             8725 non-null   float64
 27  kg             8725 non-null   float64
 28  ki             8725 non-null   float64
 29  openk          8725 non-null   float64
 30  rgdpeqa        8555 non-null   float64
 31  rgdpwok        8177 non-null   float64
 32  rgdpl2wok      8177 non-null   float64
 33  rgdpl2pe       845 non-null    float64
 34  rgdpl2te       5399 non-null   float64
 35  rgdpl2th       2274 non-null   float64
 36  rgdptt         8745 non-null   float64
dtypes: float64(33), int64(1), object(3)
memory usage: 3.2+ MB
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dtypes</span></code> 查看各变量数据类型。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country           object
isocode           object
year               int64
POP              float64
XRAT             float64
Currency_Unit     object
ppp              float64
tcgdp            float64
cgdp             float64
cgdp2            float64
cda2             float64
cc               float64
cg               float64
ci               float64
p                float64
p2               float64
pc               float64
pg               float64
pi               float64
openc            float64
cgnp             float64
y                float64
y2               float64
rgdpl            float64
rgdpl2           float64
rgdpch           float64
kc               float64
kg               float64
ki               float64
openk            float64
rgdpeqa          float64
rgdpwok          float64
rgdpl2wok        float64
rgdpl2pe         float64
rgdpl2te         float64
rgdpl2th         float64
rgdptt           float64
dtype: object
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.columns</span></code> 查看数据框列名（变量名）。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;country&#39;, &#39;isocode&#39;, &#39;year&#39;, &#39;POP&#39;, &#39;XRAT&#39;, &#39;Currency_Unit&#39;, &#39;ppp&#39;,
       &#39;tcgdp&#39;, &#39;cgdp&#39;, &#39;cgdp2&#39;, &#39;cda2&#39;, &#39;cc&#39;, &#39;cg&#39;, &#39;ci&#39;, &#39;p&#39;, &#39;p2&#39;, &#39;pc&#39;,
       &#39;pg&#39;, &#39;pi&#39;, &#39;openc&#39;, &#39;cgnp&#39;, &#39;y&#39;, &#39;y2&#39;, &#39;rgdpl&#39;, &#39;rgdpl2&#39;, &#39;rgdpch&#39;,
       &#39;kc&#39;, &#39;kg&#39;, &#39;ki&#39;, &#39;openk&#39;, &#39;rgdpeqa&#39;, &#39;rgdpwok&#39;, &#39;rgdpl2wok&#39;,
       &#39;rgdpl2pe&#39;, &#39;rgdpl2te&#39;, &#39;rgdpl2th&#39;, &#39;rgdptt&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rename()</span></code> 函数既可以用于更改行标签，也可以用于列标签。传入一个字典，其中键为当前名称，值为新名称，以更新相应的名称。</p></li>
</ul>
<p>例：</p>
<ol class="arabic simple">
<li><p>将 year 改为 Year，country 改为 Country：</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_renamed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span><span class="n">Year</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">:</span><span class="s1">&#39;Country&#39;</span><span class="p">})</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>将所有列名改为小写：</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_renamed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.index</span></code> 查看数据框行名。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=11400, step=1)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.shape</span></code> 可以查看 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 的维度，返回一个 tuple（元组对象），显示数据框的行数和列数。因此，可以用索引分别查看数据框的行数和列数。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#查看数据框行数</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#查看数据框列数</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11400
37
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ch-pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="pandas-intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.1. </span>pandas 简介</p>
      </div>
    </a>
    <a class="right-next"
       href="dataframe-slicing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.3. </span>数据切片</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">2.2.1. Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe">2.2.2. DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.2.2.1. 创建 DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2.2.2. 计算统计量</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pwt">2.2.3. 案例：PWT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.2.3.1. 查看数据</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 鲁蔚征
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>